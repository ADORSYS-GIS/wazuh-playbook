## Wazuh Vulnerability Detection – Findings Summary
#### Overview
The Vulnerability Detection module in Wazuh identifies known vulnerabilities CVEs (Common Vulnerabilities and Exposures) on monitored systems by comparing their installed software (via syscollector) against public vulnerability databases (like NVD, OVAL, RedHat, etc.).

### How It Works
#### 1. Inventory Collection
The `syscollector` module collects OS, installed packages, and hardware info from agents and sends it to the Wazuh Manager.

  ```
  <wodle name="syscollector">
    <disabled>no</disabled>
    <interval>1h</interval>
    <scan_on_start>yes</scan_on_start>
    <hardware>yes</hardware>
    <os>yes</os>
    <network>yes</network>
    <packages>yes</packages>
    <ports all="no">yes</ports>
    <processes>yes</processes>
  ```

#### 2. Feed Synchronization
The Manager downloads vulnerability feeds regularly (default: NVD; can include RedHat, Canonical, Debian, etc.).
The following configuration block shows a configuration example for the Vulnerability Detection module. You can find the Vulnerability Detection settings in the Wazuh server configuration file at /var/ossec/etc/ossec.conf.

```
<vulnerability-detection>
   <enabled>yes</enabled>
   <index-status>yes</index-status>
   <feed-update-interval>60m</feed-update-interval>
</vulnerability-detection>

<indexer>
   <enabled>yes</enabled>
   <hosts>
      <host>https://0.0.0.0:9200</host>
   </hosts>
   <ssl>
      <certificate_authorities>
         <ca>/etc/filebeat/certs/root-ca.pem</ca>
      </certificate_authorities>
      <certificate>/etc/filebeat/certs/filebeat.pem</certificate>
      <key>/etc/filebeat/certs/filebeat-key.pem</key>
   </ssl>
</indexer>
```

#### 3.Matching & Alerting
The collected software versions are compared to the feeds. If a match is found with a known CVE:

  - A vulnerability alert is triggered.

  - Alert includes: CVE ID, package name, version, severity, CVSS score, and more.

#### Diagram:

  <img src="/Operations/IMAGES/VD.png">

 
#### Sample Alert Fields:

 <img src="/Operations/IMAGES/sample-alert.png">


### Remediation Flow (Detailed)
#### 1.Review the Alert

   - Each alert includes:

      - **CVE ID** (e.g., CVE-2024-12345)

      - **Package name and version**

      - **Vulnerability status:**

          - `Active` → vulnerability is present and exploitable on the system

          - `Solved` → vulnerability no longer affects the package (usually after a patch or upgrade)

      - **Severity**: Based on CVSS v3/v2 scores

        - Low (0.1–3.9)

        - Medium (4.0–6.9)

        - High (7.0–8.9)

        - Critical (9.0–10.0)

**Note**: Check the `data.vulnerability.rationale` and `data.vulnerability.reference` for more information.          

#### 2. Take Action

- Based on the CVE and severity:

  - For `Critical/High`: prioritize patching/upgrading the affected package or applying a security workaround.

  - For `Medium/Low`: may schedule with normal patch cycles or monitor for updates.

#### 3. Apply Fixes

  - Patch or upgrade the vulnerable package manually or via automation (e.g., apt, yum, dnf, etc.)

  - Alternatively, disable/remove the vulnerable software if unused.

#### 4. Auto Re-Evaluation

  - After the fix, Wazuh automatically re-runs inventory scans via `syscollector`.

  - The vulnerability status will change from Active to Solved once the vulnerable version is no longer detected.

#### 5. Verification

You can verify remediation via the Kibana dashboard or by checking the updated alert logs.