## Incident Response Playbook â€“ Agent Disconnection

### 1. Overview
- **Playbook Name:** Agent Disconnection Response
- **Related Framework(s):** MITRE ATT&CK
- **Last Updated:** [YYYY-MM-DD]

### 2. Scope
- **Objective:** Detect and respond to an agent that has been disconnected for an extended period.
- **Use Case:** Address scenarios where an agent stops reporting for **7+ days**.
- **Applicable Systems:** Wazuh-monitored endpoints (Linux, Windows, MacOS).

### 3. Trigger Conditions

| **Trigger Type** | **Description** | **Detection Source** |
|-----------------|----------------|----------------------|
| **Alert** | Agent disconnected for 7+ days | Wazuh SIEM |
| **Event** | Agent fails multiple connection attempts | Log Analysis |


### 4. Response Actions

#### 4.1 Initial Analysis
- Confirm the disconnection event in **Wazuh Manager** logs.
- Check the agent's **last known status & timestamp**.
- Verify **host availability** (ping, SSH/RDP).

#### 4.2 Containment
- Notify responsible teams via **Slack/Jira**.
- Disable agent-related access if compromise is suspected.

#### 4.3 Eradication & Recovery
- Restart the agent service remotely.
- If the agent is unreachable:
  - **Check network connectivity** (firewall, DNS, VPN).
  - **Verify system logs** for crashes or failures.
  - **Reinstall the agent** if necessary.

#### 4.4 Post-Incident Review
- Document the root cause and corrective actions.
- Update security policies and automation rules.
- Conduct a brief **team debriefing** on findings.

### 5. References & Documentation
- **MITRE ATT&CK Tactics:** Persistence (T1547), Command & Control (T1071)
- **Wazuh Documentation:** Agent connection monitoring, troubleshooting

### 6. Incident Report

1. **Summary:** Disconnection cause and impact.
2. **Detection Details:** Logs and alerts from Wazuh.
3. **Response Actions:** Steps taken for resolution.
4. **Root Cause & Fixes:** Findings and security measures.
5. **Team & Roles:** Personnel involved in response.
