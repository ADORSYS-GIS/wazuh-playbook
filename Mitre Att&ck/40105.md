# Incident Response Playbook – Account Manipulation (T1098)

## 1. Overview

| Tactic(s)                    | Technique ID | Technique Name       | Platforms                       | Permissions Required                   | Last Updated |
|-----------------------------|--------------|----------------------|----------------------------------|----------------------------------------|--------------|
| Persistence, Privilege Escalation | T1098       | Account Manipulation | Windows, Linux, Cloud | Admin/root, Write |   |

---

## 2. Scope

**Objective:**  
Detect and respond to unauthorized account creation, modification, or permission changes to prevent persistence or privilege escalation.

**Use Cases:**
- Unauthorized password resets, permission group additions, or account creation.
- Changes to privileged accounts (e.g., adding users to Domain Admins).
- Cloud IAM role or policy manipulation.

**Applicable Systems:**  
Active Directory (AD), endpoints, databases.

---

## 3. Trigger Conditions

| Trigger Type | Description                                             | Detection Source                          |
|--------------|---------------------------------------------------------|-------------------------------------------|
| Alert        | “Null” user changed some information. | SIEM |
| User Report  | User reports unauthorized access or account changes     | Helpdesk Ticketing System                 |

---


## 4. Response Actions
### 4.1 Initial Analysis
#### 1.Verify the Alert:

- Check AD or IAM logs for suspicious changes. 

- Use PowerShell to review recent modifications

#### 2.Identify Impact:

- Determine if attackers gained access to sensitive systems via modified accounts.

- Check for lateral movement (e.g., new SSH keys, RDP sessions).

### 4.2 Containment
#### 1.Isolate Compromised Accounts:

- Disable or lock affected accounts:

  ```bash
  usermod -L <username>  # Linux  
  net user <username> /active:no  # Windows  
- Revoke temporary cloud credentials (e.g., AWS STS tokens).

### 2.Restrict Network Access (M1030):

- Segment networks to isolate critical systems (e.g., jump servers).

- Block anomalous IPs at firewalls.

#### 3.Enforce MFA (M1032):

- Require MFA reauthentication for sensitive roles.

### 4.3 Eradication & Recovery
#### 1.Revert Malicious Changes:

- Restore original account permissions using AD or IAM backups.

- Remove unauthorized users from privileged groups:
  
#### 2.Rotate Credentials:

- Reset passwords and API keys for compromised accounts.

- Invalidate SSH keys and OAuth tokens.


### 4.4 Post-Incident Review
#### 1.Root Cause Analysis:

- Identify how attackers gained permissions (e.g., phishing, insider threat).

- Audit service accounts for excessive privileges (M1026).

#### 2.Update Policies:

- Enforce approval workflows for account changes (M1018).

- Educate admins on detecting suspicious account activity.

## 5. References & Documentation
MITRE ATT&CK Documentation: T1098

Guides:
Microsoft Securing Privileged Access