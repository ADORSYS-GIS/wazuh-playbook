## Manual Playbook: Configure Audit Log Retention Policy
#### Objective
Configure audit log retention to maintain security event logs for minimum 60 days or 5GB storage to support incident investigations.

### Remediation Methods
### Terminal Method (Recommended)
Commands:

#### 1.1 Backup current configuration:
```bash
sudo cp /etc/security/audit_control /etc/security/audit_control.bak
```
#### 1.2 Set retention policy (choose one option):
Option A: Time-based retention (60 days)

```bash
sudo sed -i '' '/^expire-after:/d' /etc/security/audit_control
sudo sh -c 'echo "expire-after:60d" >> /etc/security/audit_control'
```
Option B: Size-based retention (5GB)

```bash
sudo sed -i '' '/^expire-after:/d' /etc/security/audit_control
sudo sh -c 'echo "expire-after:5G" >> /etc/security/audit_control'
```
#### 1.3 Restart audit service:
```bash
sudo launchctl unload /System/Library/LaunchDaemons/com.apple.auditd.plist
sudo launchctl load /System/Library/LaunchDaemons/com.apple.auditd.plist
```

### Check Compliance
Validation Commands:

#### For time-based retention (60+ days):

```bash
if grep -qE '^expire-after:[[:space:]]*([6-9][0-9]|[1-9][0-9]{2,})d' /etc/security/audit_control; then
   echo "COMPLIANT: Time-based retention"
elif grep -qE '^expire-after:[[:space:]]*([5-9]|[1-9][0-9]+)G' /etc/security/audit_control; then
   echo "COMPLIANT: Size-based retention"
else
   echo "NON-COMPLIANT"
fi
```