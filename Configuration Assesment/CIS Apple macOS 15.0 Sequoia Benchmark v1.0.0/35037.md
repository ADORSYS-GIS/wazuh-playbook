## Manual Playbook: Configure macOS Security Audit Flags
#### Objective
Configure system audit flags to maintain comprehensive security event logs for incident investigation and compliance.

### Remediation Methods
### Terminal Method (Recommended)
Commands:

#### 1.1 Backup current configuration:
```bash
sudo cp /etc/security/audit_control /etc/security/audit_control.bak
```
#### 1.2 Apply comprehensive audit flags:
```bash
sudo sh -c 'echo "flags:-fm,ad,-ex,aa,-fr,lo,-fw" >> /etc/security/audit_control'
```
#### OR for maximum auditing (verbose):

```bash
sudo sh -c 'echo "flags:-all,ad,aa,lo" >> /etc/security/audit_control'
```
#### 1.3 Restart audit service:
```bash
sudo launchctl unload /System/Library/LaunchDaemons/com.apple.auditd.plist
sudo launchctl load /System/Library/LaunchDaemons/com.apple.auditd.plist
```
Audit Flag Reference
|Flag|Description|Importance|
|----|-----------|----------|
|-fm |	File attribute modifications|	Critical|
|ad	|Administrative actions|	High|
|-ex|	Executions (excluded to reduce noise)|	Medium|
|aa|	Authentication and authorization	|Critical|
|-fr	|File read (excluded for most systems)|	Low|
|lo	|Login/logout events	|Critical|
|-fw	|File write (excluded when -fm used)|	Medium|
|-all	|All events (alternative to individual flags)	|Verbose|

### Check Compliance
#### Validation Command:

```bash
# Check for either configuration pattern
if grep -qE '^flags.*-all.*ad.*aa.*lo' /etc/security/audit_control || 
   grep -qE '^flags.*-fm.*-ex.*ad.*aa.*lo.*-fr.*-fw' /etc/security/audit_control; then
   echo "COMPLIANT"
else
   echo "NON-COMPLIANT"
fi
```
- **Passes if:** Either flag combination is present

- **Fails if:** Neither configuration is detected

