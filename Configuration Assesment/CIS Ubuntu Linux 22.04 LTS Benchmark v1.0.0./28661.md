### Step-by-Step Playbook: Configure Password Policy with pam_pwquality

**Objective**:  
Enforce strong password policies by configuring the `pam_pwquality` module to meet the following requirements:
- Minimum password length: **14 characters**.
- Password complexity: **At least 4 character classes** (uppercase, lowercase, digit, special).

---

#### **Step 1: Install the `libpam-pwquality` Module**
**Purpose**: Ensure the required module is installed to enforce password policies.

1. **Check if the package is installed**:
   ```bash
   apt list --installed libpam-pwquality
   ```
   - If installed, proceed to Step 2.
   - If not installed, install it:
     ```bash
     sudo apt update && sudo apt install libpam-pwquality
     ```

---

#### **Step 2: Configure Password Length (`minlen`)**
**Purpose**: Set the minimum password length to **14 characters**.

1. **Edit the configuration file**:
   ```bash
   sudo nano /etc/security/pwquality.conf
   ```

2. **Add or modify the `minlen` line**:
   ```ini
   minlen = 14
   ```
   - Save the file (`Ctrl+O`, then `Ctrl+X` in Nano).

---

#### **Step 3: Configure Password Complexity (`minclass`)**
**Purpose**: Require passwords to include **4 character classes** (uppercase, lowercase, digit, special).

1. **Edit the configuration file**:
   ```bash
   sudo nano /etc/security/pwquality.conf
   ```

2. **Add or modify the `minclass` line**:
   ```ini
   minclass = 4
   ```
   - Save the file.

---

#### **Step 4: Validate Configuration**
**Purpose**: Ensure the settings are applied correctly.

1. **Verify `minlen`**:
   ```bash
   grep "minlen" /etc/security/pwquality.conf
   ```
   - Expected output: `minlen = 14`.

2. **Verify `minclass`**:
   ```bash
   grep "minclass" /etc/security/pwquality.conf
   ```
   - Expected output: `minclass = 4`.

---

#### **Step 5: Test the Policy**
**Purpose**: Confirm the new password rules are enforced.

1. **Test a weak password** (e.g., 13-character password with 3 classes):
   ```bash
   sudo passwd testuser
   ```
   - Enter a password like `Password123!` (13 characters, 3 classes).
   - **Expected Result**: The system rejects the password with an error (e.g., "BAD PASSWORD: too short").

2. **Test a compliant password** (e.g., 14 characters with 4 classes):
   - Enter a password like `SecurePass123!` (14 characters, 4 classes).
   - **Expected Result**: The password is accepted.

---

#### **Notes**:
1. **Alternative Complexity Rules**:
   - If your organization prefers **explicit character requirements** (e.g., "at least 1 digit, 1 uppercase, etc."), replace `minclass = 4` in Step 3 with:
     ```ini
     dcredit = -1  # At least 1 digit
     ucredit = -1  # At least 1 uppercase letter
     lcredit = -1  # At least 1 lowercase letter
     ocredit = -1  # At least 1 special character
     ```
   - However, this playbook follows the **assessmentâ€™s required check** for `minclass = 4`.

2. **Policy Enforcement**:
   - The new rules apply to **new passwords only** (e.g., during user creation or password changes).

---

#### **Troubleshooting**:
- If password changes are not enforcing the policy:
  - Verify `/etc/pam.d/common-password` includes `pam_pwquality.so`:
    ```bash
    grep "pam_pwquality.so" /etc/pam.d/common-password
    ```
  - Ensure no conflicting settings exist in `/etc/security/pwquality.conf` (e.g., duplicate `minlen` lines).

---

**Outcome**:  
The system now enforces passwords of at least **14 characters** with **4 character classes**, mitigating brute-force attacks.