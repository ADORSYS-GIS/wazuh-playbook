### Step-by-Step Playbook: Configure SSH LoginGraceTime to 60 Seconds

**Objective**: Ensure the SSH server's LoginGraceTime is set to 60 seconds to mitigate brute force attacks and limit unauthenticated connections.

---

#### **Step 1: Verify Current LoginGraceTime**
**Command**:  
```bash
sshd -T | grep -E -i "logingracetime"
```
**Expected Output**:  
`logingracetime 60`  
**Action**:  
- If the output value is between `1` and `60`, proceed to Step 2.  
- If the value is `0` or `>60`, proceed to remediation (Step 3).

---

#### **Step 2: Inspect the SSH Configuration File**
**Command**:  
```bash
grep -E -i "^[[:space:]]*LoginGraceTime[[:space:]]+" /etc/ssh/sshd_config
```
**Expected Output**:  
`LoginGraceTime 60`  
**Action**:  
- If no lines are found, proceed to Step 3.  
- If lines with `0`, `>60`, or an incorrect value (e.g., `LoginGraceTime 120`) are found, proceed to Step 3.

---

#### **Step 3: Backup the Configuration File**
**Command**:  
```bash
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
```
**Purpose**:  
Ensure a rollback point in case of errors.

---

#### **Step 4: Edit the SSH Configuration File**
1. **Open the file for editing**:  
   ```bash
   sudo vi /etc/ssh/sshd_config
   ```
2. **Remove or comment invalid entries**:  
   - Find all lines starting with `LoginGraceTime`.  
   - For lines with values â‰  `60` (e.g., `LoginGraceTime 0` or `LoginGraceTime 120`):  
     - **Comment them**: Add `#` at the start (e.g., `#LoginGraceTime 120`).  
     - **Or delete them** if redundant.  
3. **Add/Update the correct parameter**:  
   - Add this line if missing:  
     ```bash
     LoginGraceTime 60
     ```
   - Ensure no duplicate `LoginGraceTime` lines exist.  

**Example Correct Configuration**:  
```
# Limit authentication window to 60 seconds
LoginGraceTime 60
```

---

#### **Step 5: Restart the SSH Service**
**Command**:  
```bash
sudo systemctl restart sshd
```
**Purpose**:  
Apply the new configuration.

---

#### **Step 6: Re-validate the Configuration**
1. **Check the effective configuration**:  
   ```bash
   sshd -T | grep -E -i "logingracetime"
   ```
   **Expected Output**: `logingracetime 60`  
2. **Verify the configuration file**:  
   ```bash
   grep -E -i "^[[:space:]]*LoginGraceTime[[:space:]]+" /etc/ssh/sshd_config
   ```
   **Expected Output**: `LoginGraceTime 60`

---

#### **Notes**:
- **Time Units**: Use only numeric values (e.g., `60`), not `60s` or `1m`.  
- **Multiple Entries**: SSH uses the first occurrence of `LoginGraceTime`. Remove duplicates.  
- **Compliance**: If the checks still fail, ensure no typos exist and that the service restarted correctly.

---

**Final Output Example**:  
```
Effective Configuration (sshd -T):
logingracetime 60

Configuration File (/etc/ssh/sshd_config):
LoginGraceTime 60
```  

This ensures compliance with the recommended security baseline.