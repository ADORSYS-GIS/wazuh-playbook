### SSH Port Forwarding Remediation Playbook

#### **Objective**:  
Disable SSH port forwarding to mitigate unauthorized data exudation and backdoor risks by configuring `AllowTcpForwarding no` in the SSH daemon.

---

### **Step 1: Verify Current SSH Configuration**
Check the live SSH configuration to confirm if `AllowTcpForwarding` is disabled.  
```bash
sudo sshd -T | grep -i 'allowtcpforwarding'
```  
**Expected Output**:  
`allowtcpforwarding no`  

If the output shows `allowtcpforwarding yes`, proceed to remediation.

---

### **Step 2: Inspect the SSH Configuration File**
Check `/etc/ssh/sshd_config` for existing `AllowTcpForwarding` settings.  
```bash
sudo grep -i '^\s*AllowTcpForwarding' /etc/ssh/sshd_config
```  
- If the output is **blank**: The parameter is not explicitly set (defaults may apply).  
- If the output shows `AllowTcpForwarding yes`: The setting must be updated.  

---

### **Step 3: Backup the Configuration File**  
Create a backup to enable rollback if needed.  
```bash
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
```

---

### **Step 4: Edit the SSH Configuration File**  
1. Open the file with a text editor:  
   ```bash
   sudo nano /etc/ssh/sshd_config
   ```
2. **Add or Modify the Parameter**:  
   - If the line `AllowTcpForwarding` exists, change its value to `no`.  
   - If it does not exist, add the following line (typically under the `# Security` or `# Forwarding` section):  
     ```ini
     AllowTcpForwarding no
     ```  
3. **Save and exit** the editor (e.g., in `nano`: `Ctrl+O` → `Enter` → `Ctrl+X`).

---

### **Step 5: Restart the SSH Service**  
Apply changes by restarting the SSH daemon.  

**For Systemd Systems (e.g., Ubuntu 16.04+, CentOS 7+)**:  
```bash
sudo systemctl restart sshd
```  

**For SysV Init Systems (e.g., CentOS 6)**:  
```bash
sudo service sshd restart
```  

---

### **Step 6: Confirm Remediation**  
1. **Verify the Live Configuration**:  
   ```bash
   sudo sshd -T | grep -i 'allowtcpforwarding'
   ```  
   **Expected Output**:  
   `allowtcpforwarding no`  

2. **Confirm the Configuration File**:  
   ```bash
   sudo grep -i '^\s*AllowTcpForwarding' /etc/ssh/sshd_config
   ```  
   **Expected Output**:  
   `AllowTcpForwarding no`  

---

### **Step 7: Post-Remediation Validation**  
- Test SSH connectivity to ensure no service disruption:  
  ```bash
  ssh localhost
  ```  
- If connectivity fails, restore the backup:  
  ```bash
  sudo cp /etc/ssh/sshd_config.bak /etc/ssh/sshd_config && sudo systemctl restart sshd
  ```

---

### **Troubleshooting**  
- **SSH Service Fails to Start**:  
  Check syntax errors in the config file:  
  ```bash
  sudo sshd -t
  ```  
- **Multiple `AllowTcpForwarding` Entries**:  
  Ensure only one entry exists in `/etc/ssh/sshd_config` (the first occurrence takes precedence).

---

### **References**  
- [SSH Hardening Best Practices](https://www.ssh.com/academy/ssh/sshd_config)  
- `man sshd_config` (for parameter documentation)  

**Playbook Owner**: [Insert Name/Team]  
**Last Updated**: [Insert Date]