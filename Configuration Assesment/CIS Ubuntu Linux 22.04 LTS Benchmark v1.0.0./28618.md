**Manual Step-by-Step Playbook: Configure Persistent Logging for systemd-journald**

---

### **Description**  
By default, `systemd-journald` may store logs in volatile memory (lost on reboot). This playbook ensures logs are persisted to disk via configuration changes and service restart.

---

### **Steps**  

#### **1. Check Current Configuration**  
**Objective**: Verify if `Storage=persistent` is already configured.  

**Commands**:  
```bash
sudo grep -E '^\s*Storage=persistent' /etc/systemd/journald.conf
```  

**Expected Results**:  
- If the output shows `Storage=persistent`, no action is needed.  
- If there is no output or the line is commented out (e.g., `#Storage=volatile`), proceed to remediation.  

---

#### **2. Remediate Configuration**  
**Objective**: Set `Storage=persistent` in `/etc/systemd/journald.conf`.  

**Steps**:  
1. **Backup the original file** (optional but recommended):  
   ```bash
   sudo cp /etc/systemd/journald.conf /etc/systemd/journald.conf.bak
   ```  

2. **Edit the configuration file**:  
   ```bash
   sudo vi /etc/systemd/journald.conf  # or use nano/another editor
   ```  

3. **Locate the `Storage` setting**:  
   - If the line `Storage=...` exists (commented or uncommented), change it to:  
     ```ini
     Storage=persistent
     ```  
   - If the line does not exist, add it under the `[Journal]` section:  
     ```ini
     [Journal]
     Storage=persistent
     ```  

4. **Save and exit the editor**.  

---

#### **3. Restart the systemd-journald Service**  
**Objective**: Apply the configuration changes.  

**Command**:  
```bash
sudo systemctl restart systemd-journald
```  

**Verification**:  
```bash
sudo systemctl status systemd-journald  # Ensure service is "active (running)"
```  

---

#### **4. Verify Persistent Logging**  
**Objective**: Confirm logs are stored on disk.  

**Commands**:  
1. **Check the configuration file**:  
   ```bash
   sudo grep 'Storage=persistent' /etc/systemd/journald.conf
   ```  
   - Expected Output: `Storage=persistent`.  

2. **Check disk usage for logs**:  
   ```bash
   journalctl --disk-usage
   ```  
   - Expected: A value indicating disk usage (e.g., `Archived and active journals take up X in disk`).  

3. **Test log persistence** (optional):  
   - Reboot the system and check if logs from before the reboot exist:  
     ```bash
     journalctl --list-boots  # Should show multiple boot IDs if logs are persistent
     ```  

---

### **Additional Notes**  
- **Critical Files**:  
  - `/etc/systemd/journald.conf`: Main configuration file.  
  - `/var/log/journal/`: Default directory for persistent logs (created automatically if `Storage=persistent`).  

- **Troubleshooting**:  
  - If logs are still volatile after reboot, ensure `/var/log/journal/` exists. Create it manually if needed:  
    ```bash
    sudo mkdir -p /var/log/journal
    sudo systemctl restart systemd-journald
    ```  

---

**Rationale**:  
Persistent logs allow forensic analysis after crashes/reboots. This configuration ensures log data is retained on disk.  

**Reference**:  
- `man journald.conf` for advanced configuration options.  
- [systemd Journal Documentation](https://www.freedesktop.org/software/systemd/man/journald.conf.html).  

--- 

**Approval**: âœ… Configuration complete when `Storage=persistent` is active and logs survive reboots.