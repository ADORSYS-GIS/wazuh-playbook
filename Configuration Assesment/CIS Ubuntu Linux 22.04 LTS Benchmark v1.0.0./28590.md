### Playbook: Install and Verify auditd & audispd-plugins for System Event Auditing

---

#### **Objective**  
Ensure `auditd` (Linux Auditing System) and `audispd-plugins` (plugins for event processing) are installed to capture system events and detect unauthorized access.

---

### **Step-by-Step Instructions**

#### **Step 1: Verify Current Installation Status**
Check if the required packages are already installed.  

1. **Open a terminal** (Ctrl+Alt+T or via SSH).  
2. **Run these commands**:  
   ```bash
   dpkg-query -s audispd-plugins
   dpkg-query -s auditd
   ```
3. **Interpret the output**:  
   - If both show `Status: install ok installed`, no further action is needed.  
   - If either shows `Status: install ok not-installed` or is not installed, proceed to Step 2.

---

#### **Step 2: Install auditd and audispd-plugins**
Use `apt` to install the packages.  

1. **Update package repositories** (ensures access to latest versions):  
   ```bash
   sudo apt update
   ```
2. **Install the packages**:  
   ```bash
   sudo apt install auditd audispd-plugins
   ```
3. **Confirm installation** when prompted (`Y`/`Yes`).

---

#### **Step 3: Verify Successful Installation**
Re-check the package status to confirm installation.  

1. **Run the verification commands again**:  
   ```bash
   dpkg-query -s audispd-plugins
   dpkg-query -s auditd
   ```
2. **Expected output**:  
   Both should now show `Status: install ok installed`.

---

### **Post-Installation Steps**

#### **1. Enable and Start the auditd Service**
Ensure `auditd` is running and enabled on boot:  
```bash
sudo systemctl enable auditd  # Enable on boot
sudo systemctl start auditd   # Start immediately
sudo systemctl status auditd  # Verify service status (should show "active (running)")
```

---

### **Troubleshooting**

#### **Issue: Installation Fails with "Package Not Found"**
- **Cause**: Package name typo or repository misconfiguration.  
- **Fix**:  
  ```bash
  # Double-check package names:
  sudo apt-cache search audispd-plugins
  sudo apt-cache search auditd
  ```

#### **Issue: Permission Denied During Installation**
- **Cause**: Missing `sudo` privileges.  
- **Fix**: Run commands with `sudo` or switch to a user with root access.

---

### **Additional Notes**

- **Configure Audit Rules**: After installation, define audit rules in `/etc/audit/audit.rules` or `/etc/audit/rules.d/` to specify which events to log.  
- **Log Location**: Audit logs are stored in `/var/log/audit/audit.log` by default.  
- **Documentation**:  
  - [Ubuntu auditd Official Documentation](https://manpages.ubuntu.com/manpages/xenial/man8/auditd.8.html)

---

### **Summary**
By following this playbook, you ensure that system events are captured via `auditd`, aiding in the detection of unauthorized access. Regularly review audit logs and rules to maintain security compliance.