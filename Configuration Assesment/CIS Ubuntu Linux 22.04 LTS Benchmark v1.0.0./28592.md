### Step-by-Step Playbook: Configure GRUB2 to Enable Early Auditing (audit=1)

---

#### **Objective**  
Ensure audit events are captured for processes starting **before** auditd by configuring the GRUB2 bootloader with `audit=1`.

---

### **Step 1: Backup Existing GRUB Configuration**
1. **Command**:  
   ```bash
   sudo cp /etc/default/grub /etc/default/grub.backup.$(date +%Y%m%d)
   ```
   - **Purpose**: Safeguard against configuration errors.

---

### **Step 2: Edit GRUB Configuration File**
1. **Open the GRUB file**:
   ```bash
   sudo nano /etc/default/grub  # Use vi/vim/editor of choice
   ```
2. **Locate `GRUB_CMDLINE_LINUX`**:
   - Example existing line:  
     `GRUB_CMDLINE_LINUX="quiet splash"`
3. **Add `audit=1` to the kernel parameters**:
   - Modified line:  
     `GRUB_CMDLINE_LINUX="quiet splash audit=1"`
   - **Critical Note**: Do not remove existing parameters unless instructed otherwise.

---

### **Step 3: Update GRUB2 Configuration**
1. **Run the update command**:
   - **Debian/Ubuntu**:  
     ```bash
     sudo update-grub
     ```
   - **RHEL/CentOS/Fedora**:  
     ```bash
     sudo grub2-mkconfig -o /boot/grub2/grub.cfg
     ```
2. **Verify success**:  
   - Look for confirmation in the output (e.g., "Found linux image...").

---

### **Step 4: Reboot the System**
1. **Command**:  
   ```bash
   sudo reboot
   ```
2. **Note**: Ensure the system is safe to restart (avoid production outages).

---

### **Step 5: Post-Reboot Verification**
1. **Check kernel parameters**:  
   ```bash
   cat /proc/cmdline | grep -ow "audit=1"
   ```
   - **Expected Output**: `audit=1`  
   - If missing, repeat Steps 2-4 and confirm no typos in `/etc/default/grub`.

---

### **Rollback Procedure**
1. **Restore the backup**:  
   ```bash
   sudo cp /etc/default/grub.backup* /etc/default/grub
   ```
2. **Update GRUB and reboot**:  
   Repeat Step 3 and Step 4.

---

### **Troubleshooting**
- **Symptom**: `audit=1` not in `/proc/cmdline`.  
  **Fix**: Confirm `update-grub` ran successfully and verify syntax in `/etc/default/grub`.
- **Symptom**: System fails to boot.  
  **Fix**: Use a live OS or recovery mode to restore the backup GRUB file.

---

### **Documentation**
- **Affected File**: `/etc/default/grub`  
- **Impact**: Requires reboot.  
- **Security Relevance**: Ensures malicious pre-auditd activity is logged.  

---

**Final Note**: Always test changes in a non-production environment first.