## Create `/var` Partition

### Preliminary Backup Step

Before proceeding, ensure you have a recent backup of critical data:

```bash
sudo rsync -avh --progress /var/ /path/to/backup/var_backup_
```

Verify the backup completed successfully before moving on.

### Phase 1: Prepare the Environment (Live USB)

1. **Boot from Ubuntu Live USB (Try Ubuntu):**

   * You cannot modify partitions in use by the running OS.

2. **Open GParted:**

   * Search and launch **GParted** from the Live Ubuntu desktop.

---

### Phase 2: Partitioning with GParted (Partition for `/var`)

1. **Identify Your Existing Root Partition:**

   * Locate your main Ubuntu installation’s root partition (e.g., `/dev/nvme0n1p5`).

2. **Shrink the Existing Root Partition:**

   * Right-click on `/dev/nvme0n1p5` and select **Resize/Move**.
   * Adjust **New size (MiB)** to free up at least **30 GiB** for `/var` (e.g., enter `30720 MiB` for the new partition).
   * Click **Resize/Move**, then click the green checkmark to **Apply All Operations**.

3. **Create New Partition for `/var`:**

   * In the now-unallocated space:

     * Right-click on **unallocated** → **New**.
     * Set **New size (MiB)** to `30720` (for 30 GiB).
     * Set **File system** to `ext4`.
     * Set **Label** to `VAR`.
     * Click **Add**, then click **Apply All Operations** to format and create `/var`.

> **Note:** Adjust the size if you require more or less space for variable data.

---

### Phase 3: Data Migration and `fstab` Configuration

1. **Identify the New `/var` Partition Device and UUID:**

   * After creation, GParted will list it (e.g., `/dev/nvme0n1p6`).
   * Right-click → **Information** → copy the **UUID**.

2. **Mount Partitions in Live USB Terminal:**

   ```bash
   sudo mkdir /mnt/ubuntu_root
   sudo mount /dev/nvme0n1p5 /mnt/ubuntu_root         # Mount existing root
   sudo mkdir /mnt/new_var
   sudo mount /dev/nvme0n1p6 /mnt/new_var               # Mount new /var partition
   ```

3. **Copy `/var` Data:**

   ```bash
   sudo rsync -avh --progress /mnt/ubuntu_root/var/ /mnt/new_var/
   ```

   * **Verify** sizes:

     ```bash
     du -sh /mnt/ubuntu_root/var
     du -sh /mnt/new_var
     ```

4. **Rename Original `/var`:**

   ```bash
   sudo mv /mnt/ubuntu_root/var /mnt/ubuntu_root/var_old
   ```

   * This acts as a backup. Once you confirm everything works, you may delete `/var_old`.

5. **Update `fstab` of Installed System:**

   ```bash
   sudo nano /mnt/ubuntu_root/etc/fstab
   ```

   * Add an entry (replace `<UUID>` with the actual UUID or replace `UUID=<UUID>` with device name `/dev/nvme0n1pX`):

     ```
     UUID=<UUID>    /var    ext4    defaults,nosuid,nodev    0   2
     ```
   * Save (Ctrl+O, Enter) and exit (Ctrl+X).

6. **Unmount and Reboot:**

   ```bash
   sudo umount /mnt/new_var
   sudo umount /mnt/ubuntu_root
   sudo reboot
   ```

---

### Phase 4: Verification

1. After booting normally, in a terminal:

   ```bash
   df -h | grep "/var"
   ls -la /var
   ```

   * Confirm `/var` is a separate mount with expected usage.

2. If everything looks correct, remove the backup folder:

   ```bash
   sudo rm -rf /var_old
   ```

Congratulations! The `/var` directory is now on its own partition.
