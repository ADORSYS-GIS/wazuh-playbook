### Manual Playbook: Secure /etc/ssh/sshd_config Ownership and Permissions

**Purpose**:  
Ensure the `/etc/ssh/sshd_config` file is protected from unauthorized changes by non-privileged users by enforcing correct ownership (`root:root`) and permissions (`600`/`-rw-------`).

---

#### **Step 1: Pre-Check File Existence**
Confirm the file exists before proceeding.

**Command**:  
```bash
ls -l /etc/ssh/sshd_config
```

**Expected Output**:  
```
-rw------- 1 root root 1234 Jan 1 12:34 /etc/ssh/sshd_config
```
- If the file is missing, investigate your SSH installation before proceeding.

---

#### **Step 2: Verify Current Ownership and Permissions**
Check the current ownership and permissions using `stat`.

**Command**:  
```bash
stat /etc/ssh/sshd_config
```

**Sample Output to Check**:  
```
Access: (0600/-rw-------)  
Uid: (    0/    root)  
Gid: (    0/    root)
```

**Validation**:  
- **Ownership**: Both `Uid` and `Gid` must be `0/root`.  
- **Permissions**: `Access` must show `0600` or `-rw-------`.

---

#### **Step 3: Remediate Ownership (If Incorrect)**  
If ownership is not `root:root`, run:

**Command**:  
```bash
sudo chown root:root /etc/ssh/sshd_config
```

**Explanation**:  
- `chown root:root` sets the owner and group to `root`.

---

#### **Step 4: Remediate Permissions (If Incorrect)**  
If permissions are not `600`, run:

**Command**:  
```bash
sudo chmod og-rwx /etc/ssh/sshd_config
```
*Or equivalently*:
```bash
sudo chmod 600 /etc/ssh/sshd_config
```

**Explanation**:  
- `og-rwx` removes read, write, and execute permissions for "others" and "group".

---

#### **Step 5: Post-Remediation Verification**  
Re-run the `stat` command to confirm changes.

**Command**:  
```bash
stat /etc/ssh/sshd_config
```

**Expected Post-Remediation Output**:  
```
Access: (0600/-rw-------)  
Uid: (    0/    root)  
Gid: (    0/    root)
```

---

#### **Step 6: (Optional) Confirm SSH Service Functionality**  
Ensure the SSH service is operational after changes.  
*Note: Permission changes do not affect running services, but itâ€™s good practice to confirm connectivity.*

**Command**:  
```bash
sudo systemctl status sshd
```

**Action**:  
- If the service is inactive, restart it:  
  ```bash
  sudo systemctl restart sshd
  ```
- Test SSH access from another session before closing the current one.

---

**Final Notes**:  
- Repeat these steps after major system updates or configuration changes.  
- Audit file permissions regularly using automation tools (e.g., cron jobs, CIS-CAT).  

**References**:  
- CIS Benchmarks for SSH Server Configuration.  
- Linux man pages: `chown(1)`, `chmod(1)`, `sshd_config(5)`.  

**Approval**:  
Ensure changes align with organizational change management policies.  

**Revision History**:  
- v1.0 - [Date] Initial playbook created.  

---

**Tagging**:  
#SSH #Hardening #ConfigurationManagement #LinuxSecurity