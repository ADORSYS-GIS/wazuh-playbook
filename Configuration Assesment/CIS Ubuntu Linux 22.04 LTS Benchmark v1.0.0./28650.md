**Step-by-Step Playbook for Configuring SSH MaxStartups**

**Objective**: Ensure SSH MaxStartups is set to `10:30:60` to prevent denial of service via excessive unauthenticated connections.

---

### **1. Verify Current Runtime Configuration**
**Command**:  
```bash
sshd_output=$(sshd -T | grep -i maxstartups)
echo "Current MaxStartups: $sshd_output"
```
**Expected Output**:  
`maxstartups 10:30:60`

**Check Compliance**:  
- If the output matches exactly `maxstartups 10:30:60`, proceed to **Step 2** (file check).  
- If not, proceed to **Step 3** to correct the configuration.

---

### **2. Check Configuration File for Correct Settings**
**Command**:  
```bash
config_file="/etc/ssh/sshd_config"
current_config=$(grep -i "^MaxStartups" "$config_file" || echo "Not set")
echo "Config File Value: $current_config"
```
**Expected Line**:  
`MaxStartups 10:30:60`

**Check Compliance**:  
- If the line exists, is uncommented, and matches exactly `MaxStartups 10:30:60`, no action needed.  
- If the line is missing, incorrect, or commented out, proceed to **Step 3**.

---

### **3. Edit SSH Configuration File**
**Actions**:  
1. Open the file for editing:  
   ```bash
   sudo nano /etc/ssh/sshd_config
   ```
2. **Add/Modify the Line**:  
   - Locate `MaxStartups` (use `Ctrl+W` to search in nano).  
   - If present, modify to:  
     ```bash
     MaxStartups 10:30:60
     ```
   - If absent, add the line under the `# Authentication` section.  
   - Ensure the line is **not** prefixed with `#` (to uncomment if necessary).  
3. Save and exit (`Ctrl+O` → `Enter` → `Ctrl+X`).

---

### **4. Restart SSH Service**
**Command**:  
```bash
sudo systemctl restart sshd  # For systemd systems
# OR
sudo service sshd restart    # For init.d systems
```

---

### **5. Re-verify Runtime Configuration**
**Command**:  
```bash
sshd -T | grep -i maxstartups
```
**Expected Output**:  
`maxstartups 10:30:60`

**Outcome**:  
- If the output matches, the configuration is successful.  
- If not, validate the config file syntax with `sshd -t` (checks for errors) and repeat steps.

---

### **6. Validation Checks (Optional)**
To ensure compliance with all security policies:  
1. **Check Runtime Values**:  
   ```bash
   # First value (must be ≤10 and ≥1)
   sshd -T | grep -oP 'maxstartups\s+\K\d+'
   # Second value (must be ≤30 and ≥1)
   sshd -T | grep -oP 'maxstartups\s+\d+:\K\d+'
   # Third value (must be ≤60 and ≥1)
   sshd -T | grep -oP 'maxstartups\s+\d+:\d+:\K\d+'
   ```
2. **Check Config File for Prohibited Values**:  
   ```bash
   grep -i MaxStartups /etc/ssh/sshd_config | grep -E '0|:[3-9][1-9]:|:[6-9][1-9]+\b'
   ```
   - If no output, the file is compliant.  
   - If output exists, correct the file and restart SSH.

---

**Final Notes**:  
- Replace `nano` with `vim`/`vi` if preferred.  
- Test SSH connectivity after restarting the service.  
- Monitor logs (`/var/log/auth.log`) for SSH connection issues post-change.