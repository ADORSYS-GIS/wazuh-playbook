### Manual Playbook: Configure audit_backlog_limit Kernel Parameter

---

#### **Assessment Steps**

**Objective**: Verify if the `audit_backlog_limit` parameter is configured in all `grub.cfg` files under `/boot`.

1. **Locate `grub.cfg` Files**  
   Identify all `grub.cfg` files in the `/boot` directory:
   ```bash
   sudo find /boot -name "grub.cfg"
   ```
   Example output:  
   `/boot/grub/grub.cfg`  
   `/boot/efi/EFI/ubuntu/grub.cfg`

2. **Check for `audit_backlog_limit` Parameter**  
   For each identified `grub.cfg` file, check if `audit_backlog_limit` is set to a numeric value (e.g., `8192`):
   ```bash
   sudo grep -P 'audit_backlog_limit=\d+' /path/to/grub.cfg
   ```
   Example command:
   ```bash
   sudo grep -P 'audit_backlog_limit=\d+' /boot/grub/grub.cfg
   ```

   - **Compliant System**:  
     Output includes `linux.*audit_backlog_limit=8192` (or another number ≥8192).  
     Example:  
     `linux /vmlinuz-5.4.0-90-generic root=/dev/sda1 ro audit_backlog_limit=8192`

   - **Non-Compliant System**:  
     No output or a value `<8192`.

3. **Check Current Kernel Parameters (Optional)**  
   Verify if the parameter is active in the running kernel:
   ```bash
   cat /proc/cmdline | grep -P 'audit_backlog_limit=\d+'
   ```
   - **Note**: This reflects the current boot configuration but does not guarantee persistence after reboot.

---

#### **Remediation Steps**

**Objective**: Configure `audit_backlog_limit=8192` (or higher) in GRUB and regenerate the configuration.

1. **Edit GRUB Configuration**  
   Open `/etc/default/grub` for editing:
   ```bash
   sudo nano /etc/default/grub
   ```

2. **Modify `GRUB_CMDLINE_LINUX`**  
   Locate the line starting with `GRUB_CMDLINE_LINUX=` and append `audit_backlog_limit=8192` to the existing parameters.  

   **Before**:  
   ```bash
   GRUB_CMDLINE_LINUX="console=tty0 crashkernel=auto"
   ```

   **After**:  
   ```bash
   GRUB_CMDLINE_LINUX="console=tty0 crashkernel=auto audit_backlog_limit=8192"
   ```

   - **Note**: Use a value ≥8192 (e.g., `16384` for high-traffic systems).

3. **Update GRUB Configuration**  
   Regenerate `grub.cfg` using the appropriate command for your OS:  

   - **Debian/Ubuntu**:
     ```bash
     sudo update-grub
     ```
   - **RHEL/CentOS**:
     ```bash
     sudo grub2-mkconfig -o /boot/grub2/grub.cfg
     ```

4. **Reboot the System**  
   Apply the new kernel parameter:
   ```bash
   sudo reboot
   ```

---

#### **Verification Steps**

1. **Confirm `grub.cfg` Updates**  
   Repeat **Assessment Step 2** to ensure all `grub.cfg` files include `audit_backlog_limit=8192`.

2. **Verify Active Kernel Parameter**  
   After reboot, confirm the parameter is active:
   ```bash
   cat /proc/cmdline | grep -P 'audit_backlog_limit=\d+'
   ```
   Example output:  
   `BOOT_IMAGE=/vmlinuz-5.4.0-90-generic root=/dev/sda1 ro audit_backlog_limit=8192`

---

#### **Additional Notes**

- **Critical Systems**: Use a larger value (e.g., `16384`) if the system generates high volumes of audit logs.
- **Distribution-Specific Commands**: Adjust the `update-grub` command based on your OS (e.g., `grub2-mkconfig` for RHEL).
- **Fallback Plan**: Test changes in a non-production environment before applying to critical systems.

---

**Impact**:  
A reboot is required for the parameter to take effect. Plan maintenance windows accordingly.