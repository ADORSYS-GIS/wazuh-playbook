# Manual Playbook: systemd-timesyncd Remediation

### Objective
Ensure proper time synchronization using `systemd-timesyncd` or disable it if another NTP service is active.



## 1. Verify Current Time Sync Status
Check if `systemd-timesyncd` or other NTP services are running:

```bash
# Check systemd-timesyncd status
systemctl is-active systemd-timesyncd.service
systemctl is-enabled systemd-timesyncd.service

# Check for other NTP services
systemctl is-active chronyd ntpd
```
#### Expected Results
- If systemd-timesyncd is active/enabled, proceed with ensuring proper configuration.

- If another NTP service (e.g., chronyd, ntpd) is running, systemd-timesyncd should be masked to prevent conflicts.

## 2. Remediation Steps

### Option A: Use systemd-timesyncd (No Other NTP Service)

If no other NTP service is active, enable and configure `systemd-timesyncd`:
```bash
# Unmask and enable
sudo systemctl unmask systemd-timesyncd.service

sudo systemctl --now enable systemd-timesyncd.service
```
```bash
# Verify
systemctl status systemd-timesyncd.service

timedatectl timesync-status
```
Then restart:

```bash
sudo systemctl restart systemd-timesyncd.service
```

### Option B: Disable systemd-timesyncd (Other NTP Active)

If another NTP service (e.g., chronyd, ntpd) is active, stop and mask systemd-timesyncd to prevent conflicts
```bash
# Stop and mask
sudo systemctl --now stop systemd-timesyncd.service
sudo systemctl disable systemd-timesyncd.service
sudo systemctl mask systemd-timesyncd.service
```
```bash
# Verify
systemctl status systemd-timesyncd.service
```
## 3. Validation Checks
After remediation, confirm the correct service is running:

```bash
# Check active time sync service
timedatectl status
```
```bash
# Verify systemd-timesyncd status (if enabled)
systemctl is-active systemd-timesyncd.service
systemctl is-enabled systemd-timesyncd.service
```
```bash
# Check time synchronization status
timedatectl timesync-status
```
#### Expected Outcomes
- If using systemd-timesyncd:

   - Service should be active (running) and enabled.

   - timedatectl should show "NTP synchronized: yes".

- If using another NTP service:

   - systemd-timesyncd should be masked/inactive.

   - The alternative service (e.g., chronyd) should be active.

## 4. Troubleshooting
- **Conflict Errors:** If time keeps fluctuating, ensure only one NTP service is running.

- **Sync Failures:** Check network connectivity to NTP servers (ping pool.ntp.org).

- **Logs:** Use journalctl -u systemd-timesyncd for debugging.

### Summary
- ✅ Use systemd-timesyncd alone → Enable & configure it.
- ✅ Using another NTP service → Mask systemd-timesyncd.
- ✅ Verify with timedatectl and systemctl status.


