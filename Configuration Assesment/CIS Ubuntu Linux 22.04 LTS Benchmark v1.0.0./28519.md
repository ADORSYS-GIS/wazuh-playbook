## Create a Separate `/home` Partition
### (Optional) Backup Entire Root Before Resizing

Before shrinking or resizing the root partition, it’s prudent to back up the entire root filesystem so you can restore if something goes wrong. Use your preferred method (disk image, filesystem snapshot, or rsync).

### 1. Preliminary Checks

#### a. Check Current `/home` Size on the Installed System
Before creating a new `/home` partition, check how much data is in `/home` and choose an appropriate size.

1. Boot normally into your installed Ubuntu system.
2. Open a terminal and run:
   ```bash
   sudo du -sh /home
   sudo df -h /home
   ```

* `du -sh /home` shows total size of existing user data.
* `df -h /home` shows filesystem usage and free space.

3. Based on these outputs, decide how much space to allocate for `/home` (e.g., if current data is 100 GiB, you might allocate 250 GiB or more depending on future needs).
---

### 2. Boot Live USB

1. **Boot from Ubuntu Live USB (Try Ubuntu):**

   * Necessary because you cannot modify mounted root partitions.
2. **Launch GParted:**

   * From the Live desktop, open **GParted**.

---

### 3. Partitioning with GParted

#### a. Identify and Shrink the Existing Root Partition (if needed)

1. In GParted, locate your Ubuntu root partition (`<ROOT_PARTITION>`).
2. If you need to free space for `/home`, right-click `<ROOT_PARTITION>` → **Resize/Move**.
3. Free the desired amount (e.g., remaining free space or \~250 GiB). In **Free Space Following (MiB)**, enter the size in MiB (e.g., `256000` for \~250 GiB).
4. Click **Resize/Move**, then Apply All Operations (green checkmark).

#### b. Create New Partition for `/home`

1. In the unallocated space:

   * Right-click **unallocated** → **New**.
   * Set **New size (MiB)** to the chosen size (e.g., maximum available or specific value).
   * Set **File system** to `ext4`.
   * (Optional) Set **Label** to `HOME_PART` or leave blank.
   * Click **Add**.
2. Click the green checkmark (Apply All Operations) to create and format.
3. Note the device name assigned (e.g., `/dev/sdXN` or `/dev/nvme0n1pY`); refer to it as `<NEW_HOME_PARTITION>`.

> **Note:** Use placeholders: replace `<ROOT_PARTITION>` and `<NEW_HOME_PARTITION>` with actual device paths you observe.

---

### 4. Data Migration and `fstab` Update

1. **Find the UUID of the New Partition:**

   * In GParted, right-click `<NEW_HOME_PARTITION>` → **Information** → copy **UUID**.
   * Or in terminal:

     ```bash
     sudo blkid /dev/<NEW_HOME_PARTITION>
     ```

     and note `UUID="..."`.

2. **Mount Partitions in Live USB Terminal:**

   ```bash
   sudo mkdir -p /mnt/ubuntu_root
   sudo mount /dev/<ROOT_PARTITION> /mnt/ubuntu_root
   sudo mkdir -p /mnt/new_home
   sudo mount /dev/<NEW_HOME_PARTITION> /mnt/new_home
   ```

3. **Copy Existing `/home` Data:**

   ```bash
   sudo rsync -avh --progress /mnt/ubuntu_root/home/ /mnt/new_home/
   ```

   * Verify sizes:

     ```bash
     sudo du -sh /mnt/ubuntu_root/home
     sudo du -sh /mnt/new_home
     ```
   * Ensure data matches or is very close.

4. **Rename (Backup) Original `/home`:**

   ```bash
   sudo mv /mnt/ubuntu_root/home /mnt/ubuntu_root/home_old
   ```

   * Keeps a fallback. Delete `home_old` after confirming success.

5. **Edit `fstab` in the Installed System:**

   ```bash
   sudo nano /mnt/ubuntu_root/etc/fstab
   ```

   * Add a line for `/home`. You can choose:

     * **UUID entry** (robust if device names change):

       ```
       UUID=<UUID_OF_NEW_HOME>    /home    ext4    defaults,nosuid,nodev    0   0
       ```
     * **Direct device path** (simpler but may break if naming shifts):

       ```
       /dev/<NEW_HOME_PARTITION>    /home    ext4    defaults,nosuid,nodev    0   0
       ```
   * **Reasoning**:

     * **UUID**: Stable across reboots and unaffected by disk-order changes; preferred for reliability.
     * **Device path**: Easier to type initially, but if disk enumeration changes, mount could fail.
   * Save and exit (Ctrl+O, Enter; Ctrl+X).

6. **Unmount and Reboot:**

   ```bash
   sudo umount /mnt/new_home
   sudo umount /mnt/ubuntu_root
   sudo reboot
   ```

---

### 5. Post-Reboot Verification

1. After booting into your installed Ubuntu:

   ```bash
   df -h | grep "/home"
   ls -la /home
   ```

   * Confirm `/home` is a separate mount with expected user data.
2. If all works, remove the backup copy:

   ```bash
   sudo rm -rf /home_old
   ```

   * Only after verifying user data and configurations operate normally.

---

### Summary of Placeholder Conventions

* `<ROOT_PARTITION>`: your existing root filesystem partition (e.g., `/dev/sda3`, `/dev/nvme0n1p5`).
* `<NEW_HOME_PARTITION>`: the newly created partition for `/home` (e.g., `/dev/sda6`, `/dev/nvme0n1p10`).
* `<UUID_OF_NEW_HOME>`: filesystem UUID of `<NEW_HOME_PARTITION>`, from GParted or `blkid`.
* `<BACKUP_DESTINATION>`: path or mount point for backups (e.g., `/media/ubuntu/BackupDrive` or `user@server:/backups/home`).

> **Tips:**
>
> * Double-check device identifiers before destructive operations.
> * Ensure a reliable backup before modifying partitions.
> * Choose partition size based on current `/home` usage plus anticipated growth.
> * To revert during testing, restore `/home_old` back to `/home` and remove or comment out the fstab entry.
