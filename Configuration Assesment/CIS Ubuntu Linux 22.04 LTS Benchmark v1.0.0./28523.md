# **Playbook: Secure `/dev/shm` Configuration (nodev, noexec, nosuid) with nano**

## **Objective**  
Harden the `/dev/shm` temporary filesystem by ensuring it's mounted with:
- **`nodev`** - Prevents device file creation
- **`noexec`** - Blocks binary execution
- **`nosuid`** - Disables SUID/SGID permissions

## **Step-by-Step Guide**

### **Step 1: Check Current Mount Options**
```bash
findmnt --kernel /dev/shm
```
âœ… **Proper output should show:** `rw,nosuid,nodev,noexec`

### **Step 2: Edit /etc/fstab Using nano**
```bash
sudo nano /etc/fstab
```

**If an entry exists:**  
Locate the `/dev/shm` line and ensure it includes all three options:
```
tmpfs /dev/shm tmpfs rw,nosuid,nodev,noexec,relatime 0 0
```

**If no entry exists:**  
Add this line at the end:
```
tmpfs /dev/shm tmpfs defaults,nosuid,nodev,noexec 0 0
```

ðŸ’¡ **nano tips:**
- Use arrow keys to navigate
- Ctrl+O to save (then press Enter)
- Ctrl+X to exit

### **Step 3: Apply Changes Immediately**
```bash
sudo mount -o remount /dev/shm
```

### **Step 4: Verify Configuration**
```bash
findmnt --kernel /dev/shm | grep -E 'nodev|noexec|nosuid'
```
âœ… **Should show all three options**

### **Step 5: Ensure Persistence After Reboot**
```bash
sudo reboot
```
After reboot, repeat Step 4 to verify.

## **Quick Command Summary**
```bash
# Check current settings
findmnt --kernel /dev/shm

# Edit config (using nano)
sudo nano /etc/fstab

# Apply changes
sudo mount -o remount /dev/shm

# Verify
findmnt --kernel /dev/shm | grep -E 'nodev|noexec|nosuid'

# Make permanent (optional)
sudo reboot
```

## **Why This Matters**
- **Security:** Prevents attackers from creating malicious devices or executing code
- **Compliance:** Meets CIS Benchmark requirements
- **Safety:** Reduces privilege escalation risks
