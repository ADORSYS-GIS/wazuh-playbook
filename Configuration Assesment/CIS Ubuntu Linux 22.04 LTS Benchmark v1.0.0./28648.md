### SSH Banner Configuration Playbook

#### **Step 1: Verify Current SSH Banner Configuration**
**Command:**  
```bash
sudo grep -i "^Banner" /etc/ssh/sshd_config
```

**Expected Output:**  
`Banner /etc/issue.net`  
- If the output matches the above, the banner is already configured. Proceed to **Step 3** to verify the banner content.  
- If the line is commented (e.g., `#Banner /some/path`) or points to an incorrect file, proceed to **Step 2**.  
- If no output is returned, the banner is not configured.

---

#### **Step 2: Edit the SSH Configuration File**  
1. Open `/etc/ssh/sshd_config` with a text editor (e.g., `sudo vi /etc/ssh/sshd_config`).  
2. Locate the `Banner` directive:  
   - If it exists, uncomment the line (remove `#`) and set it to `Banner /etc/issue.net`.  
   - If it does not exist, add the line `Banner /etc/issue.net` to the file (typically under the `# Authentication` section).  

**Example Configuration Snippet:**  
```plaintext
# Example of overriding settings on a per-user basis
Banner /etc/issue.net
```

3. Save and exit the editor.

---

#### **Step 3: Create or Update the Banner File**  
1. Create or edit the banner file:  
   ```bash
   sudo vi /etc/issue.net
   ```  
2. Add a legal warning message. Example:  
   ```plaintext
   WARNING: Unauthorized access to this system is prohibited. 
   All connections are monitored. By accessing this system, you consent to monitoring.
   ```  
   **Note:** Consult legal counsel to ensure compliance with organizational policies and laws.  

3. Set strict permissions and ownership:  
   ```bash
   sudo chmod 644 /etc/issue.net
   sudo chown root:root /etc/issue.net
   ```

---

#### **Step 4: Validate SSH Configuration Syntax**  
Test for syntax errors before restarting SSH:  
```bash
sudo sshd -t
```  
- **No output** indicates success.  
- If errors appear (e.g., `Bad configuration options`), revisit **Step 2** to fix typos.

---

#### **Step 5: Restart the SSH Service**  
**For systemd systems (Ubuntu/CentOS/RHEL):**  
```bash
sudo systemctl restart sshd
```  
**For SysVinit systems (older Linux):**  
```bash
sudo service ssh restart
```  

Verify the service is active:  
```bash
sudo systemctl status sshd  # or `sudo service ssh status`
```

---

#### **Step 6: Confirm the Banner is Displayed**  
1. Test the banner locally (replace `localhost` with the server IP if remote):  
   ```bash
   ssh localhost
   ```  
   **Expected Result:** The banner message appears **before** the login prompt.  

2. Alternatively, use `ssh-keyscan` for a quick check:  
   ```bash
   ssh-keyscan -p 22 localhost
   ```

---

### **Validation Checklist**
- [ ] `/etc/ssh/sshd_config` contains `Banner /etc/issue.net`.  
- [ ] `/etc/issue.net` exists and displays the approved warning.  
- [ ] File permissions for `/etc/issue.net` are **644** and owned by **root:root**.  
- [ ] SSH service restarts without errors.  
- [ ] Banner appears during SSH login attempts.

---

### **Troubleshooting**
- **SSH Connection Fails After Restart:**  
  Check for typos in `/etc/ssh/sshd_config` using `sshd -t`.  
- **Banner Not Displayed:**  
  Ensure the banner file is readable (`sudo cat /etc/issue.net`).  
- **Permission Denied:**  
  Verify ownership with `ls -l /etc/issue.net`.

---

### **References**  
- NIST Guidelines: System connections must display legal notices before authentication.  
- Remediation aligns with CIS Benchmark recommendations.