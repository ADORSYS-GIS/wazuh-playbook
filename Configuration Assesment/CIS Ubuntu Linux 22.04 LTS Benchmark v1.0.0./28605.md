**Manual Step-by-Step Playbook for Configuring Audit Immutable Mode**

**Objective**: Ensure audit rules are immutable, requiring a reboot to modify, preventing unauthorized changes.

---

### **Step 1: Verify Existing Configuration**
1. **Check if `-e 2` is already set**:
   ```bash
   grep -r "^-e\s\+2$" /etc/audit/rules.d/
   ```
   - **No matches found**: Proceed to Step 2.
   - **Match found**: Configuration is already applied. Skip to Step 4.

---

### **Step 2: Add Immutable Mode Flag to Audit Rules**
1. **Create/Edit the finalize rules file**:
   ```bash
   sudo nano /etc/audit/rules.d/99-finalize.rules
   ```
   - Add the line `-e 2` at the **end** of the file.
   - Save and exit.

   **OR**

   Use `printf` to append the line:
   ```bash
   sudo printf -- "-e 2\n" >> /etc/audit/rules.d/99-finalize.rules
   ```

---

### **Step 3: Load Updated Audit Rules**
1. **Merge and activate the new rules**:
   ```bash
   sudo augenrules --load
   ```

---

### **Step 4: Confirm Audit Configuration Status**
1. **Check if `enabled=2` (immutable mode)**:
   ```bash
   sudo auditctl -s | grep "enabled"
   ```
   - **Output Example**:
     ```
     enabled 2
     ```
   - **If `enabled 2`**: Immutable mode is **active** (no reboot needed).
   - **If `enabled 1`**: Proceed to Step 5.

---

### **Step 5: Reboot the System (If Required)**
1. **Reboot if `enabled` is not `2`**:
   ```bash
   if ! sudo auditctl -s | grep -q "enabled 2"; then
     echo "Reboot required to enforce immutable mode."
     sudo reboot
   fi
   ```

---

### **Post-Reboot Validation**
1. **Confirm immutable mode after reboot**:
   ```bash
   sudo auditctl -s | grep "enabled"
   ```
   - Ensure output shows `enabled 2`.

---

### **Notes**:
- **Critical Correction**: The original remediation script had an inverted reboot check. This playbook uses the corrected logic.
- **Immediate Effect**: Loading rules with `-e 2` activates immutable mode **without reboot**. A reboot is only required if the rules fail to load (e.g., syntax errors).
- **Post-Configuration**: Once in immutable mode, **no audit changes** are allowed until the next reboot.

---

**Summary**: This playbook ensures audit rules are immutable, mitigating unauthorized tampering. Always validate the final state with `auditctl -s`.